# ğŸš€ gafka - ë¶„ì‚° ë©”ì‹œì§€ í ì‹œìŠ¤í…œ ì„¤ê³„ ë¬¸ì„œ

> **ê¸°ê°„**: 2024ë…„ 7ì›” 28ì¼ ~ 9ì›” 26ì¼ (9ì£¼)  
> **ëª©í‘œ**: Kafka í•µì‹¬ ê°œë…ì„ ë‹´ì€ ë©”ì‹œì§€ í MVP êµ¬í˜„ + ë¶„ì‚° ì‹œìŠ¤í…œ ì„¤ê³„ ì—­ëŸ‰ ìŠµë“

---

## 1. ğŸ§  Why - ì™œ ì´ ì‹œìŠ¤í…œì„ ë§Œë“œëŠ”ê°€?

### ğŸ“Œ ë¬¸ì œ ì •ì˜

ê¸°ì¡´ ì‹œìŠ¤í…œì—ì„œ ì„œë¹„ìŠ¤ ê°„ ì§ì ‘ í˜¸ì¶œ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ì€ í•œê³„ë¥¼ ê°€ì§„ë‹¤:

* **ê²°í•©ë„**: í”„ë¡œë“€ì„œì™€ ì»¨ìŠˆë¨¸ ê°„ ê°•ê²°í•©ìœ¼ë¡œ ì„œë¹„ìŠ¤ ë³€ê²½ ì‹œ ì˜í–¥ë„ê°€ í¼
* **í™•ì¥ì„±**: ëŒ€ìš©ëŸ‰ ì²˜ë¦¬ ì‹œ ë™ì‹œì„± í™•ë³´ ì–´ë ¤ì›€
* **ì‹ ë¢°ì„±**: ë„¤íŠ¸ì›Œí¬ ì´ìŠˆ ë°œìƒ ì‹œ ë©”ì‹œì§€ ìœ ì‹¤ ê°€ëŠ¥
* **ë³µì›ë ¥**: ì¥ì•  ì‹œ ì „ì²´ íë¦„ ì¤‘ë‹¨ (ì˜ˆ: ë™ê¸° í˜¸ì¶œ ì‹¤íŒ¨ ì „íŒŒ)

### ğŸ¯ ì„¤ê³„ ëª©í‘œ

| í•­ëª©               | ëª©í‘œ ìˆ˜ì¹˜                       | í…ŒìŠ¤íŠ¸ ì¡°ê±´                     |
|-------------------|----------------------------|-----------------------------|
| **ì²˜ë¦¬ëŸ‰ (Throughput)** | â‰¥ 5,000 msg/s (1KB ë©”ì‹œì§€ ê¸°ì¤€) | ë‹¨ì¼ ë¸Œë¡œì»¤ + 2íŒŒí‹°ì…˜ (HTTP/JSON í•œê³„ ê³ ë ¤) |
| **ì§€ì—°ì‹œê°„ (Latency)**   | í‰ê·  â‰¤ 100ms, P95 â‰¤ 200ms      | E2E ì¸¡ì • (Producerâ†’Consumer) |
| **ë‚´êµ¬ì„±**              | ìŠ¹ì¸ëœ ë©”ì‹œì§€ 100% ë³µêµ¬ ë³´ì¥               | WAL ê¸°ë°˜ ì™„ì „ ë³µêµ¬ í…ŒìŠ¤íŠ¸              |
| **ì¥ì•  ë³µêµ¬ ì‹œê°„**         | â‰¤ 30ì´ˆ (ìˆ˜ë™ ë³µêµ¬ í¬í•¨)            | ë¸Œë¡œì»¤ ê°•ì œ ì¢…ë£Œ í›„ ë³µêµ¬ ì‹œë‚˜ë¦¬ì˜¤        |
| **ìˆœì„œ ë³´ì¥**            | íŒŒí‹°ì…˜ ë‚´ 100% ìˆœì„œ ë³´ì¥            | ë©”ì‹œì§€ ìˆœì„œ í…ŒìŠ¤íŠ¸                 |

---

## 2. ğŸ“Œ What - ë¬´ì—‡ì„ ë§Œë“œëŠ”ê°€?

### âœ”ï¸ ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­
- [x] **í† í”½/íŒŒí‹°ì…˜ êµ¬ì¡°**: hash(key) % partitions ë¼ìš°íŒ…
- [x] **ë©”ì‹œì§€ ë°°ì¹­ ë° ì „ì†¡**: ë„¤íŠ¸ì›Œí¬ íš¨ìœ¨ì„± í–¥ìƒ (100ê°œ ë˜ëŠ” 10ms ë‹¨ìœ„)
- [x] **ì˜¤í”„ì…‹ ê¸°ë°˜ ì†Œë¹„ ë° ì¬ì²˜ë¦¬**: ì¥ì•  ì‹œ íŠ¹ì • ì§€ì ë¶€í„° ì¬ì‹œì‘
- [x] **ë©”ì‹œì§€ ì˜ì†í™” (WAL)**: ë¸Œë¡œì»¤ ì¬ì‹œì‘ í›„ì—ë„ ë°ì´í„° ìœ ì§€
- [x] **Consumer Group ì§€ì›**: ë©”ì‹œì§€ ë³‘ë ¬ ì²˜ë¦¬ ë° ë¡œë“œ ë°¸ëŸ°ì‹±
- [x] **Long Polling ê¸°ë°˜ Pull**: ì‹¤ì‹œê°„ì„±ê³¼ íš¨ìœ¨ì„± ê· í˜•
- [x] **ë¦¬ë”-íŒ”ë¡œì›Œ ë³µì œ**: ë°ì´í„° ì´ì¤‘í™” (ë‹¨ìˆœ êµ¬í˜„)
- [x] **Heartbeat & íŒŒí‹°ì…˜ í• ë‹¹ ìœ ì§€**: Consumer ìƒì¡´ í™•ì¸

| **ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­** |
- [x] **ê³ ì„±ëŠ¥ ì²˜ë¦¬**: 5K msg/s ì´ìƒ (HTTP/JSON ì œì•½ ê³ ë ¤)
- [x] **í‰ê·  ì§€ì—°ì‹œê°„**: 100ms ì´í•˜
- [x] **ì¥ì•  ë³µêµ¬**: ì‹œë‚˜ë¦¬ì˜¤ ê¸°ë°˜ ë³µêµ¬ ë§¤ë‰´ì–¼
- [x] **í…ŒìŠ¤íŠ¸ ê¸°ë°˜ ê°œë°œ**: TDD ì ìš©
- [x] **í™•ì¥ ê°€ëŠ¥ ì•„í‚¤í…ì²˜**: Phase 2ì—ì„œ gRPC/TCP ë§ˆì´ê·¸ë ˆì´ì…˜

### ğŸ“– ì˜ˆìƒ ì‹œë‚˜ë¦¬ì˜¤
1. **ë¡œê·¸ ìˆ˜ì§‘**: ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ â†’ ì¤‘ì•™ ì €ì¥ì†Œ ì „ë‹¬
2. **ì´ë²¤íŠ¸ ì²˜ë¦¬**: ì£¼ë¬¸ ìƒì„± ì´ë²¤íŠ¸ â†’ ì¬ê³ /ê²°ì œ ì„œë¹„ìŠ¤ ì•Œë¦¼
3. **ë°ì´í„° íŒŒì´í”„ë¼ì¸**: ì‹¤ì‹œê°„ ë°ì´í„° â†’ ë¶„ì„ ì‹œìŠ¤í…œ ì „ë‹¬

---

## 3. âš™ï¸ How - ì–´ë–»ê²Œ êµ¬í˜„í•  ê²ƒì¸ê°€?

### ğŸ§± ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ (MVP)

```mermaid
flowchart TD
    Producer["Producer(CLI or SDK)"] --> Broker1["Broker-1(Leader)"]
    Broker1 --> WAL1[(WAL File)]
    Broker1 --> Broker2["Broker-2(Follower)"]
    Broker2 --> WAL2[(WAL File)]
    Consumer1["Consumer-1(Group-A)"] --> Broker1
    Consumer2["Consumer-2(Group-B)"] --> Broker1
    Admin[Admin CLI] --> Broker1
```

### ğŸ§© ì£¼ìš” ì»´í¬ë„ŒíŠ¸ì™€ ì±…ì„

| ì»´í¬ë„ŒíŠ¸ | ì—­í•  | ì„¤ëª… |
|---------|------|------|
| **Producer** | ë©”ì‹œì§€ ì „ì†¡, íŒŒí‹°ì…”ë‹ | key ê¸°ë°˜ ë¼ìš°íŒ… (hash(key) % N) |
| **Broker** | ë©”ì‹œì§€ ìˆ˜ì‹ /ì €ì¥/ì„œë¹™ | WAL ê¸°ë°˜ ì˜ì†ì„±, Consumer ìš”ì²­ ì‘ë‹µ |
| **Consumer** | ë©”ì‹œì§€ Pull, ì˜¤í”„ì…‹ ê´€ë¦¬ | Long Polling, ì»¨ìŠˆë¨¸ ê·¸ë£¹ ì§€ì› |
| **Coordinator (MVP ë‹¨ìˆœí™”)** | Consumer Group ë° í• ë‹¹ ìƒíƒœ ìœ ì§€ | ì¸ë©”ëª¨ë¦¬ êµ¬í˜„, Heartbeatë¡œ ë¦¬ë°¸ëŸ°ì‹± ê°ì§€ |
| **WAL** | ë©”ì‹œì§€ ë³µêµ¬ìš© ë¡œê·¸ | offset, checksum í¬í•¨ |
| **Replication** | ë¦¬ë”â†’íŒ”ë¡œì›Œ ë¹„ë™ê¸° ë³µì œ | ë¦¬ë” ê¸°ì¤€ ìµœì‹  ë©”ì‹œì§€ ì „ë‹¬ |

### ğŸ§  ì½”ë””ë„¤ì´í„° ì„¤ê³„ (ê°„ì†Œí™” MVP ê¸°ì¤€)

| í•­ëª© | MVP ì„¤ê³„ ê¸°ì¤€ |
|------|-------------|
| **Group Metadata** | ë¸Œë¡œì»¤ ì¸ë©”ëª¨ë¦¬ë¡œ ê´€ë¦¬ (etcd ë“± ì™¸ë¶€ ë„êµ¬ ì—†ìŒ) |
| **Consumer Registration** | `group_id`, `consumer_id`ë¡œ ë“±ë¡ |
| **Heartbeat API** | ì£¼ê¸°ì  í˜¸ì¶œ (ì˜ˆ: 5ì´ˆ) ì—†ìœ¼ë©´ ë¦¬ë°¸ëŸ°ì‹± |
| **Partition Assignment** | Round-Robin ë°©ì‹ ë‹¨ìˆœ êµ¬í˜„ |
| **Failover ëŒ€ì‘** | heartbeat ëˆ„ë½ ì‹œ â†’ íŒŒí‹°ì…˜ ì¬í• ë‹¹ |

### ë°ì´í„° ëª¨ë¸ë§

```go
// ë©”ì‹œì§€ êµ¬ì¡°
type Message struct {
    Topic     string    `json:"topic"`
    Partition int32     `json:"partition"`
    Offset    int64     `json:"offset"`
    Key       string    `json:"key,omitempty"`
    Value     string    `json:"value"`          // MVPì—ì„œëŠ” stringìœ¼ë¡œ ë‹¨ìˆœí™”
    Timestamp int64     `json:"timestamp"`
    Size      int32     `json:"size"`           // ë©”ì‹œì§€ í¬ê¸° (KB ì œí•œìš©)
}

// WAL ì—”íŠ¸ë¦¬
type WALEntry struct {
    Offset    int64   `json:"offset"`
    Message   Message `json:"message"`
    Checksum  uint32  `json:"checksum"`         // CRC32 ì²´í¬ì„¬
}

// íŒŒí‹°ì…˜ êµ¬ì¡°
type Partition struct {
    ID          int32             `json:"id"`
    Messages    []Message         `json:"-"`        // ì¸ë©”ëª¨ë¦¬
    OffsetIndex map[int64]int     `json:"-"`        // ì˜¤í”„ì…‹ â†’ ì¸ë±ìŠ¤
    LastOffset  int64             `json:"last_offset"`
    WALPath     string            `json:"wal_path"`
    MaxSize     int64             `json:"max_size"` // íŒŒí‹°ì…˜ ìµœëŒ€ í¬ê¸° (MB)
    mutex       sync.RWMutex      `json:"-"`        // ë™ì‹œì„± ì œì–´
}
```

---

## 4. ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

| í•­ëª© | ê¸°ìˆ  | ì´ìœ  |
|------|------|------|
| **ì–¸ì–´** | Go 1.22 | ë¹ ë¥¸ ë™ì‹œì„± ì²˜ë¦¬, ê°„ë‹¨í•œ ë°°í¬ |
| **í†µì‹ ** | HTTP + JSON | ê°œë°œ í¸ì˜ì„± ìš°ì„  (ì„±ëŠ¥ ì œì•½ ì¸ì§€) |
| **ì €ì¥** | In-memory + WAL íŒŒì¼ | ì˜ì†ì„±ê³¼ ì„±ëŠ¥ ê°„ ê· í˜• |
| **CLI** | Cobra | ì»¤ë§¨ë“œ ë¼ì¸ ë„êµ¬ ê°œë°œ |
| **í…ŒìŠ¤íŠ¸** | `go test` | TDD ê¸°ë°˜ ê°œë°œ |
| **ì„±ëŠ¥ ì¸¡ì •** | wrk, custom tool | Throughput, P95 ì¸¡ì • |
| **ë¡œê¹…** | logrus | ë‹¨ê³„ë³„ ë¡œê¹… ì²˜ë¦¬ |

### ì•Œë ¤ì§„ ì„±ëŠ¥ ì œì•½ì‚¬í•­

| ì œì•½ ìš”ì†Œ | ì˜í–¥ | ì™„í™” ë°©ì•ˆ |
|---------|------|----------|
| **HTTP/JSON ì˜¤ë²„í—¤ë“œ** | JSON íŒŒì‹±ìœ¼ë¡œ ì¸í•œ ì²˜ë¦¬ëŸ‰ ì œí•œ (5K msg/s) | ë°°ì¹­ìœ¼ë¡œ ì™„í™”, Phase 2ì—ì„œ gRPC ë§ˆì´ê·¸ë ˆì´ì…˜ |

### ì‹œìŠ¤í…œ ì œí•œì‚¬í•­
| **ì¸ë©”ëª¨ë¦¬ ì €ì¥ì†Œ** | íŒŒí‹°ì…˜ë‹¹ 1M ë©”ì‹œì§€ ì œí•œ | WAL ê¸°ë°˜ ì¬ì‹œì‘ ì‹œ ë³µêµ¬, í–¥í›„ ì„¸ê·¸ë¨¼íŠ¸ ë¶„í•  |

| ì œí•œ í•­ëª© | ìµœëŒ€ê°’ | ì´ìœ  |
|---------|-------|------|
| **ë©”ì‹œì§€ í¬ê¸°** | 1MB | HTTP ìš”ì²­ í¬ê¸° ì œí•œ, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê´€ë¦¬ |
| **í† í”½ë‹¹ íŒŒí‹°ì…˜ ìˆ˜** | 100ê°œ | Consumer Group ê´€ë¦¬ ë³µì¡ë„ ì œí•œ |
| **íŒŒí‹°ì…˜ë‹¹ ë©”ì‹œì§€ ìˆ˜** | 1Mê°œ | ì¸ë©”ëª¨ë¦¬ ì €ì¥ í•œê³„ |
| **Consumer Group ìˆ˜** | ì œí•œ ì—†ìŒ | ê° ê·¸ë£¹ì€ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬ |
| **Topicëª… ê¸¸ì´** | 255ì | íŒŒì¼ì‹œìŠ¤í…œ í˜¸í™˜ì„± |
| **Consumer ID ê¸¸ì´** | 128ì | HTTP URL ê¸¸ì´ ì œí•œ |

---

## 5. ğŸš€ ì‹¤í–‰ ë°©ë²•

```bash
# 1. í”„ë¡œì íŠ¸ í´ë¡  ë° ë¹Œë“œ
git clone <repo> && cd gafka
make build

# 2. ë¸Œë¡œì»¤ ì‹œì‘ (ë¦¬ë”)
./bin/broker --id=1 --port=9001 --data-dir=/tmp/gafka-1 --role=leader

# 3. ë¸Œë¡œì»¤ ì‹œì‘ (íŒ”ë¡œì›Œ)  
./bin/broker --id=2 --port=9002 --data-dir=/tmp/gafka-2 --role=follower --leader=localhost:9001

# 4. í† í”½ ìƒì„±
./bin/admin create-topic --name=test-topic --partitions=2 --broker=localhost:9001

# 5. ë©”ì‹œì§€ ì „ì†¡
./bin/producer --topic=test-topic --broker=localhost:9001 --message="Hello World" --key="user123"

# 6. ë©”ì‹œì§€ ì†Œë¹„ (Long Polling)
./bin/consumer --topic=test-topic --group=test-group --broker=localhost:9001 --timeout=30s
```

### API ì‚¬ìš© ì˜ˆì‹œ

```bash
# ë©”ì‹œì§€ ì „ì†¡
curl -X POST http://localhost:9001/api/v1/produce \
  -H "Content-Type: application/json" \
  -d '{"topic":"test-topic","key":"user123","value":"Hello World"}'

# ë©”ì‹œì§€ ì†Œë¹„ (Consumer Group ê¸°ë°˜ - ë¸Œë¡œì»¤ê°€ offset ê´€ë¦¬)
curl "http://localhost:9001/api/v1/consume?topic=test-topic&count=10&consumer_id=consumer-1&group_id=test-group&timeout=30s"

# ë©”ì‹œì§€ ì†Œë¹„ (ê°œë³„ Consumer - ì§ì ‘ offset ì§€ì •)
curl "http://localhost:9001/api/v1/consume?topic=test-topic&partition=0&offset=100&count=10&timeout=30s"

# Consumer Group ìƒíƒœ í™•ì¸
curl "http://localhost:9001/api/v1/consumer-groups/test-group/status"

# Consumer Heartbeat
curl -X POST "http://localhost:9001/api/v1/consumer-groups/test-group/members/consumer-1/heartbeat"
```

---

## 6. ğŸ§ª ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ê³„íš

### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

| í…ŒìŠ¤íŠ¸ í•­ëª© | ë„êµ¬ | ëª©í‘œ | ê²€ì¦ ë°©ë²• |
|----------|-----|------|----------|
| **ì²˜ë¦¬ëŸ‰ ì¸¡ì •** | wrk + Lua | â‰¥5K msg/s | 1KB ë©”ì‹œì§€ë¡œ 30ì´ˆ ë¶€í•˜ |
| **ì§€ì—°ì‹œê°„ ì¸¡ì •** | Go client | P95 â‰¤ 200ms | produce â†’ consume ì¸¡ì • |
| **ì¥ì•  ë³µêµ¬** | ìˆ˜ë™ | â‰¤30ì´ˆ | ë¸Œë¡œì»¤ kill í›„ ë³µì› |
| **ë°°ì¹˜ íš¨ê³¼** | wrk | TPS ë¹„êµ | ë°°ì¹˜ vs ë‹¨ê±´ ì „ì†¡ ë¹„êµ |

### ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸

```lua
-- scripts/produce.lua (wrkìš©)
wrk.method = "POST"
wrk.headers["Content-Type"] = "application/json"

-- 1KB ë©”ì‹œì§€ë¡œ í…ŒìŠ¤íŠ¸
local message_1kb = string.rep("a", 1024)

function request()
    local body = string.format('{"topic":"test-topic","key":"test-%d","value":"%s"}', 
        math.random(1000), message_1kb)
    return wrk.format(wrk.method, wrk.path, wrk.headers, body)
end

function response(status, headers, body)
    if status ~= 200 and status ~= 201 then
        print("Error: " .. status .. " " .. body)
    end
end

function done(summary, latency, requests)
    print("Throughput: " .. string.format("%.2f", summary.requests / (summary.duration / 1000000)) .. " requests/sec")
    print("Average latency: " .. latency.mean / 1000 .. "ms")
end
```

---

## 7. ğŸ§ª TDD ê°œë°œ ê°€ì´ë“œ

### TDD ì‚¬ì´í´ ì ìš©
```
Red â†’ Green â†’ Refactor ì‚¬ì´í´ ë°˜ë³µ
1. ì‹¤íŒ¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì‘ì„±
2. í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ëŠ” ìµœì†Œ ì½”ë“œ êµ¬í˜„  
3. ì½”ë“œ ê°œì„  (ë¦¬íŒ©í† ë§)
```

### ì£¼ì°¨ë³„ TDD ëª©í‘œ

| ì£¼ì°¨ | TDD í…ŒìŠ¤íŠ¸ ëŒ€ìƒ | ì˜ˆì‹œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ |
|-----|-------------|---------------|
| **1-2ì£¼ì°¨** | ë©”ì‹œì§€ êµ¬ì¡°ì²´, íŒŒí‹°ì…˜ ë¡œì§ | `TestMessage_Serialize()`, `TestPartition_AddMessage()` |
| **3-4ì£¼ì°¨** | í”„ë¡œë“€ì„œ/ì»¨ìŠˆë¨¸ API | `TestProducer_SendMessage()`, `TestConsumer_PullMessages()` |
| **5-6ì£¼ì°¨** | WAL ì˜ì†í™”, Consumer Group | `TestWAL_WriteAndRecover()`, `TestConsumerGroup_Rebalancing()` |
| **7-8ì£¼ì°¨** | í†µí•© í…ŒìŠ¤íŠ¸, ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ | `TestBroker_HandleHighLoad()`, `TestFailover_Recovery()` |
| **9ì£¼ì°¨** | E2E í…ŒìŠ¤íŠ¸, ë¬¸ì„œí™” | `TestFullWorkflow_ProducerToBrokerToConsumer()` |

---

## 8. ğŸ§¾ ì˜ˆìƒ ì§ˆë¬¸ & ëŒ€ì‘ ì „ëµ

| ì§ˆë¬¸ | ëŒ€ì‘ |
|-----|-----|
| **ì™œ Kafka í´ë¡ ì„ Goë¡œ ë§Œë“œë‚˜ìš”?** | ë™ì‹œì„±, í•™ìŠµ íš¨ìœ¨, ê°€ë…ì„±ì—ì„œ Goê°€ ì í•© |
| **ì™¸ë¶€ Zookeeper/etcd ì™œ ì•ˆ ì¼ë‚˜ìš”?** | MVPì—ì„  ì˜¤íˆë ¤ ë³µì¡ë„ ì¦ê°€. í–¥í›„ í™•ì¥ ê³„íš ìˆìŒ |
| **ë©”ì‹œì§€ ìˆœì„œëŠ” ì–´ë–»ê²Œ ë³´ì¥ë˜ë‚˜ìš”?** | íŒŒí‹°ì…˜ ë‚´ offset ë‹¨ìœ„ ìˆœì°¨ ì²˜ë¦¬, key ê¸°ë°˜ íŒŒí‹°ì…”ë‹ |
| **ë¸Œë¡œì»¤ ì¥ì•  ì‹œ ë³µêµ¬ëŠ” ì–´ë–»ê²Œ ë˜ë‚˜ìš”?** | WAL íŒŒì¼ ê¸°ë°˜ ìë™ ë³µêµ¬ + íŒ”ë¡œì›Œâ†’ë¦¬ë” ìˆ˜ë™ ìŠ¹ê²©. ë¦¬ë” ì„ ì¶œ ìë™í™”ëŠ” Phase 2 |
| **Pull ë°©ì‹ì˜ ì‹¤ì‹œê°„ì„±ì€ ì–´ë–»ê²Œ ë³´ì¥ë˜ë‚˜ìš”?** | Long Polling ì‚¬ìš©, ìµœëŒ€ 30ì´ˆ ì´ë‚´ ì‘ë‹µ ë³´ì¥ |
| **WAL ì†ìƒ ì‹œ ë³µêµ¬ëŠ” ì–´ë–»ê²Œ ë˜ë‚˜ìš”?** | CRC32 ê¸°ë°˜ ì†ìƒ ê²€ì¦, ë³µêµ¬ ì‹¤íŒ¨ ì‹œ fail-safe ì²˜ë¦¬ í•„ìš” |
| **ë©”ì‹œì§€ ì¤‘ë³µ ë°©ì§€ëŠ”?** | at-least-onceë§Œ ë³´ì¥. ì¤‘ë³µ ë°©ì§€ëŠ” Consumerì—ì„œ ì²˜ë¦¬ í•„ìš” |
| **Consumer Groupì—ì„œ ë™ì‹œì„± ë¬¸ì œëŠ” ì–´ë–»ê²Œ í•´ê²°í•˜ë‚˜ìš”?** | Heartbeat + íŒŒí‹°ì…˜ í• ë‹¹ìœ¼ë¡œ í•œ íŒŒí‹°ì…˜ì€ í•œ Consumerë§Œ ì†Œë¹„. 409 Conflictë¡œ ì¤‘ë³µ ë°©ì§€ |
| **HTTP + JSON ì„±ëŠ¥ í•œê³„ëŠ” ì–´ë–»ê²Œ í•´ê²°í•˜ë‚˜ìš”?** | MVPì—ì„œëŠ” ê°œë°œ í¸ì˜ì„± ìš°ì„ . 5K msg/s ëª©í‘œë¡œ í˜„ì‹¤ì  ì„¤ì •. Phase 2ì—ì„œ gRPCë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ |
| **Zero-copy ìµœì í™”ëŠ” HTTPì—ì„œ ê°€ëŠ¥í•œê°€ìš”?** | HTTP ìŠ¤íƒì—ì„œëŠ” ë¶ˆê°€ëŠ¥. Phase 2ì—ì„œ TCP ê¸°ë°˜ ì»¤ìŠ¤í…€ í”„ë¡œí† ì½œë¡œ ì „í™˜í•´ì•¼ êµ¬í˜„ ê°€ëŠ¥ |

---

## 9. ğŸ—“ï¸ ê°œë°œ ì¼ì • (ì£¼ì°¨ë³„)

| ì£¼ì°¨ | í•µì‹¬ êµ¬í˜„ ì‚¬í•­ | TDD ëª©í‘œ | ê²€ì¦ ê¸°ì¤€ |
|-----|-------------|----------|----------|
| **1ì£¼ì°¨<br/>(7/28-8/3)** | í”„ë¡œì íŠ¸ ì…‹ì—…, ë©”ì‹œì§€ êµ¬ì¡°ì²´ | Message, Partition ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ | í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ > 80% |
| **2ì£¼ì°¨<br/>(8/4-8/10)** | íŒŒí‹°ì…˜ ë¡œì§, WAL ê¸°ë³¸ êµ¬í˜„ | WAL ì½ê¸°/ì“°ê¸° í…ŒìŠ¤íŠ¸ | íŒŒì¼ ì˜ì†í™” ë™ì‘ í™•ì¸ |
| **3ì£¼ì°¨<br/>(8/11-8/17)** | HTTP API, í”„ë¡œë“€ì„œ êµ¬í˜„ | HTTP í•¸ë“¤ëŸ¬ í…ŒìŠ¤íŠ¸ | 1K msg/s ì²˜ë¦¬ í™•ì¸ |
| **4ì£¼ì°¨<br/>(8/18-8/24)** | ì»¨ìŠˆë¨¸, ì˜¤í”„ì…‹ ê´€ë¦¬ | ì»¨ìŠˆë¨¸ ê·¸ë£¹ í…ŒìŠ¤íŠ¸ | E2E ë©”ì‹œì§€ í”Œë¡œìš° ë™ì‘ |
| **5ì£¼ì°¨<br/>(8/25-8/31)** | ë°°ì¹­, ì„±ëŠ¥ ìµœì í™” | ë°°ì¹­ ë¡œì§ í…ŒìŠ¤íŠ¸ | 5K msg/s ëª©í‘œ ë‹¬ì„± |
| **6ì£¼ì°¨<br/>(9/1-9/7)** | Consumer Group, íŒŒí‹°ì…˜ í• ë‹¹ | ë¦¬ë°¸ëŸ°ì‹± í…ŒìŠ¤íŠ¸ | Consumer ì¶”ê°€/ì‚­ì œ ì‹œ ìë™ ì¬í• ë‹¹ |
| **7ì£¼ì°¨<br/>(9/8-9/14)** | ë³µì œ ê¸°ëŠ¥, ì¥ì•  ë³µêµ¬ | ë³µì œ ë™ê¸°í™” í…ŒìŠ¤íŠ¸ | ë°ì´í„° ì¼ê´€ì„± í™•ì¸, 30ì´ˆ ë‚´ ë³µêµ¬ |
| **8ì£¼ì°¨<br/>(9/15-9/21)** | ì„±ëŠ¥ í…ŒìŠ¤íŠ¸, ë²„ê·¸ ìˆ˜ì • | ë¶€í•˜ í…ŒìŠ¤íŠ¸ ìë™í™” | ëª¨ë“  ì„±ëŠ¥ ëª©í‘œ ë‹¬ì„± |
| **9ì£¼ì°¨<br/>(9/22-9/26)** | ë¬¸ì„œí™”, ë°ëª¨ ì¤€ë¹„ | í†µí•© í…ŒìŠ¤íŠ¸ ì™„ë£Œ | README, API ë¬¸ì„œ ì™„ì„± |

---

## 10. ğŸ“¦ ë””ë ‰í† ë¦¬ êµ¬ì¡° (Go Best Practice)

```
gafka/
â”œâ”€â”€ cmd/                           # ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì 
â”‚   â”œâ”€â”€ broker/
â”‚   â”‚   â””â”€â”€ main.go               # ë¸Œë¡œì»¤ ì„œë²„ ì‹¤í–‰
â”‚   â”œâ”€â”€ producer/
â”‚   â”‚   â””â”€â”€ main.go               # í”„ë¡œë“€ì„œ CLI
â”‚   â”œâ”€â”€ consumer/
â”‚   â”‚   â””â”€â”€ main.go               # ì»¨ìŠˆë¨¸ CLI
â”‚   â””â”€â”€ admin/
â”‚       â””â”€â”€ main.go               # ê´€ë¦¬ ë„êµ¬ CLI
â”œâ”€â”€ internal/                      # ë‚´ë¶€ íŒ¨í‚¤ì§€ (ì™¸ë¶€ ë…¸ì¶œ ë¶ˆê°€)
â”‚   â”œâ”€â”€ broker/                   # ë¸Œë¡œì»¤ ì½”ì–´ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ broker.go
â”‚   â”‚   â”œâ”€â”€ broker_test.go
â”‚   â”‚   â”œâ”€â”€ partition.go
â”‚   â”‚   â”œâ”€â”€ partition_test.go
â”‚   â”‚   â”œâ”€â”€ wal.go
â”‚   â”‚   â”œâ”€â”€ wal_test.go
â”‚   â”‚   â”œâ”€â”€ replication.go
â”‚   â”‚   â””â”€â”€ replication_test.go
â”‚   â”œâ”€â”€ producer/                 # í”„ë¡œë“€ì„œ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ producer.go
â”‚   â”‚   â”œâ”€â”€ producer_test.go
â”‚   â”‚   â”œâ”€â”€ batcher.go
â”‚   â”‚   â”œâ”€â”€ batcher_test.go
â”‚   â”‚   â””â”€â”€ partitioner.go
â”‚   â”œâ”€â”€ consumer/                 # ì»¨ìŠˆë¨¸ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ consumer.go
â”‚   â”‚   â”œâ”€â”€ consumer_test.go
â”‚   â”‚   â”œâ”€â”€ group.go
â”‚   â”‚   â”œâ”€â”€ group_test.go
â”‚   â”‚   â””â”€â”€ offset.go
â”‚   â””â”€â”€ api/                      # HTTP API í•¸ë“¤ëŸ¬
â”‚       â”œâ”€â”€ handlers.go
â”‚       â”œâ”€â”€ handlers_test.go
â”‚       â”œâ”€â”€ middleware.go
â”‚       â””â”€â”€ routes.go
â”œâ”€â”€ pkg/                          # ì™¸ë¶€ íŒ¨í‚¤ì§€ (ì¬ì‚¬ìš© ê°€ëŠ¥)
â”‚   â”œâ”€â”€ protocol/                 # ë©”ì‹œì§€ í”„ë¡œí† ì½œ
â”‚   â”‚   â”œâ”€â”€ message.go
â”‚   â”‚   â””â”€â”€ message_test.go
â”‚   â””â”€â”€ client/                   # Go í´ë¼ì´ì–¸íŠ¸ SDK
â”‚       â”œâ”€â”€ client.go
â”‚       â””â”€â”€ client_test.go
â”œâ”€â”€ configs/                      # ì„¤ì • íŒŒì¼
â”‚   â”œâ”€â”€ broker.yaml
â”‚   â””â”€â”€ examples/
â”œâ”€â”€ scripts/                      # ìŠ¤í¬ë¦½íŠ¸ ë° ë„êµ¬
â”‚   â”œâ”€â”€ produce.lua              # wrk í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ setup.sh                 # í™˜ê²½ ì„¤ì •
â”‚   â””â”€â”€ benchmark.sh             # ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ docs/                        # ë¬¸ì„œ
â”‚   â”œâ”€â”€ api.md                   # API ë¬¸ì„œ
â”‚   â”œâ”€â”€ architecture.md          # ì•„í‚¤í…ì²˜ ê°€ì´ë“œ
â”‚   â””â”€â”€ operations.md            # ìš´ì˜ ê°€ì´ë“œ
â”œâ”€â”€ examples/                    # ì‚¬ìš© ì˜ˆì‹œ
â”‚   â”œâ”€â”€ simple_producer/
â”‚   â””â”€â”€ simple_consumer/
â”œâ”€â”€ Makefile                     # ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ go.mod                       # Go ëª¨ë“ˆ ì •ì˜
â”œâ”€â”€ go.sum                       # ì˜ì¡´ì„± ì²´í¬ì„¬
â”œâ”€â”€ README.md                    # í”„ë¡œì íŠ¸ ê°œìš”
â””â”€â”€ .gitignore                   # Git ë¬´ì‹œ íŒŒì¼
```

---

## 11. ğŸ“Œ í–¥í›„ ê³¼ì œ

### Phase 1 - MVP (í˜„ì¬)
- [x] ê¸°ë³¸ í”„ë¡œë“€ì„œ/ì»¨ìŠˆë¨¸ êµ¬í˜„
- [x] ë‹¨ì¼ ë¸Œë¡œì»¤ WAL ì €ì¥ì†Œ
- [x] HTTP API ê¸°ë°˜ í†µì‹ 

### Phase 2 - ì„±ëŠ¥ ìµœì í™” ë° í”„ë¡œí† ì½œ ë§ˆì´ê·¸ë ˆì´ì…˜
- [ ] gRPC ê¸°ë°˜ í†µì‹ ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜
- [ ] TCP ì»¤ìŠ¤í…€ í”„ë¡œí† ì½œ (Zero-copy ì§€ì›)
- [ ] ë©”ì‹œì§€ ì••ì¶• (gzip, snappy)
- [ ] Consumer Group ì˜¤í”„ì…‹ ì˜ì†í™”

### Phase 3 - ë¶„ì‚° ì‹œìŠ¤í…œ í™•ì¥
- [ ] ë¦¬ë” ìë™ ì„ ì¶œ (Raft ë“±)
- [ ] í¬ë¡œìŠ¤ ë°ì´í„°ì„¼í„° ë³µì œ
- [ ] íŒŒí‹°ì…˜ ìë™ ë¶„í• 
### Phase 4 - ìš´ì˜ ê¸°ëŠ¥
### Phase 4 - ìš´ì˜ ê¸°ëŠ¥
- [ ] Prometheus ê¸°ë°˜ ëª¨ë‹ˆí„°ë§
- [ ] TLS, ì¸ì¦ ë“± ë³´ì•ˆ ê¸°ëŠ¥
- [ ] Docker ì»¨í…Œì´ë„ˆ ë°°í¬
- [ ] Kubernetes ë§¤ë‹ˆí˜ìŠ¤íŠ¸

---

## âœ… ì„±ê³µ ê¸°ì¤€

### ê¸°ëŠ¥ì  ê¸°ì¤€
- [x] **ë©”ì‹œì§€ ì²˜ë¦¬ëŸ‰**: ë‹¨ì¼ ë¸Œë¡œì»¤ 5K msg/s ì´ìƒ (1KB ë©”ì‹œì§€, HTTP/JSON ê¸°ì¤€)
- [x] **ë©”ì‹œì§€ ìˆœì„œ ë³´ì¥**: íŒŒí‹°ì…˜ ë‚´ 100% ìˆœì„œ ìœ ì§€
- [x] **ë°ì´í„° ì˜ì†ì„±**: ìŠ¹ì¸ëœ ë©”ì‹œì§€ WAL ê¸°ë°˜ 100% ë³µêµ¬ ë³´ì¥
- [x] **ê¸°ë³¸ ë³µì œ**: ë¦¬ë”-íŒ”ë¡œì›Œ ê°„ ë¹„ë™ê¸° ë³µì œ ì •ìƒ ë™ì‘
- [x] **Consumer Group**: íŒŒí‹°ì…˜ë³„ ë‹¨ì¼ Consumer ë³´ì¥

### ê¸°ìˆ ì  ê¸°ì¤€
- [x] **í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€**: 80% ì´ìƒ ìœ ì§€
- [x] **TDD ì¤€ìˆ˜**: ëª¨ë“  ê¸°ëŠ¥ì„ í…ŒìŠ¤íŠ¸ ë¨¼ì € ì‘ì„±
- [x] **ì½”ë“œ í’ˆì§ˆ**: Go lint ê·œì¹™ ì¤€ìˆ˜
- [x] **API ë¬¸ì„œ**: OpenAPI ìŠ¤í™ ì™„ì„±

### í•™ìŠµ ëª©í‘œ ë‹¬ì„±ë„
- [x] **ë©”ì‹œì§€ í í•µì‹¬ ê°œë…**: í† í”½, íŒŒí‹°ì…˜, ì˜¤í”„ì…‹ ì´í•´
- [x] **ë¶„ì‚° ì‹œìŠ¤í…œ ê¸°ì´ˆ**: ë³µì œ, ì¼ê´€ì„±, ì¥ì•  ë³µêµ¬ ê²½í—˜
- [x] **ê³ ì„±ëŠ¥ I/O**: WAL, ë°°ì¹­ ê¸°ë²• êµ¬í˜„
- [x] **TDD ì—­ëŸ‰**: í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ ì™„ì„±
